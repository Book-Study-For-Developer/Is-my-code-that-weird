# 12장 메서드(함수): 좋은 클래스에는 좋은 메서드가 있다.

메서드 설계는 클래스 설계와 아주 밀접한 관련이 있습니다.<br>
메서드 설계가 좋지 않으면, 클래스 설계도 나빠집니다.<br>
반대로 메서드 설계가 좋으면, 클래스 설계도 좋아집니다.

## 1. 반드시 현재 클래스의 인스턴스 변수(멤버 변수) 사용하기

메서드는 반드시 현재 클래스의 인스턴스 변수를 사용하도록 설계합니다. 물론 예외도 있지만, 이것이 기본 원칙 입니다.

추가로, 생성자는 인스턴스를 생성하기 위한 특수한 메서드 입니다.<br>
완전 생성자 패턴을 사용해서 생성자에 가드를 만들어 두면, 인스턴스 변수를 안전하게 사용하기 위한 첫걸음을 뗐다고 할 수 있습니다.

다른 클래스의 인스턴스 변수를 변경하는 메서드는 좋지 않습니다.<br>
응집도가 낮은 구조가 될 수 있기 때문입니다.<br>
다른 클래스의 인스턴스 변수를 변경하는 메서드를 작성하고 싶다면, 변경된 내용을 다루는 새로운 인스턴스를 생성하고 이를 리턴하는 형태로 구현하는 것이 좋습니다.

## 2. 불변을 활용해서 예상할 수 있는 메서드 만들기

가변 인스턴스 변수 등을 변경하는 메서드는 예상하지 못한 동작이 발생할 수 있으며, 유지 보수가 어려워집니다.

## 3. 묻지 말고 명령하라

어떤 클래스가 다른 클래스의 상태를 판단하거나, 상태에 따라 값을 변경하는 등 '다른 클래스를 확인하고 조작하는 메서드 구조'는 응집도가 낮은 구조입니다.

getter/setter는 '다른 클래스를 확인하고 조작하는 메서드 구조'가 되기 쉽습니다.

호출되는 메서드 쪽에서 복잡한 처리를 하는 형태로 만드는 '묻지 말고 명령하라'로 만드는 것이 좋습니다.

## 캡슐화의 오해

'캡슐화는 getter/setter를 구현하는 것이다'라고 설명하고, 이렇게 이해하고 있는 사람들이 종종 있습니다.<br>
그럴 수밖에 없는 이유는 방금 언급했던 것처럼 여러 개발 도구에서 getter/setter를 자동으로 구현해주는 기능에 '캡슐화'라는 이름을 붙이고 있기 때문입니다.

캡슐화는 데이터와 그 데이터를 조작하는 로직을 하나의 클래스로 만들고, 필요한 로직(메서드)만 외부에 공개하는 것입니다.<br>
캡슐화를 활용하면 응집도가 낮은 구조가 생겨나지 않게 억제할 수 있습니다.<br>
또한 잘못된 상태로부터 클래스를 보호하는 유효성 검사(validation) 등을 함께 활용하면, 안전한 인스턴스를 만들 수 있습니다.

## 4. 커맨드/쿼리 분리

상태 변경과 추출을 동시에 하는 메서드는 여러 문제의 원인이 됩니다.

커맨드/쿼리 분리(CQS, Commnad-Query Separation)라는 패턴이 있습니다.<br>
메서드는 커맨드 또는 쿼리 중에 하나만 하도록 설계해야 한다는 패턴입니다.

| 메서드 종류 구분 | 설명                |
|-----------|-------------------|
| 커맨드       | 상태를 변경하는 것        |
| 쿼리        | 상태를 리턴하는 것        |
| 모디파이어     | 커맨드와 쿼리를 동시에 하는 것 |

상황에 따라 모디파이어로 만들 수밖에 없는 메서드도 있지만, 그야말로 예외이고 최대한 피하는 것이 좋습니다.

## 5. 매개변수

### 5.1 불변 매개변수로 만들기

매개변수를 변경하면 값의 의미가 바뀌어서, 어떤 의미를 나타내는지 유추하기 어렵습니다. 또한, 어디에서 변경되었는지 찾기도 힘듭니다.

매개변수를 변경하고 싶으면, 불변 지역 변수를 만들고, 여기에 변경 값을 할당하는 형태로 구현합니다.

### 5.2 플래그 매개변수 사용하지 않기

플래그 매개변수를 받는 메서드는 코드를 읽는 사람이 메서드가 무슨 일을 하는지 알기 어렵게 만듭니다.

전략 패턴을 사용하는 등, 다른 구조로 설계를 개선하세요.

### 5.3 null 전달하지 않기

null을 전달하지 않게 설계하려면, null에 의미를 부여해서는 안됩니다.<br>
예를 들어서 장비를 작용하지 않은 상태를 null로 나타내지 않고 Equipment.EMPTY로 표현하도록 합니다.

### 5.4 출력 매개변수 사용하지 않기

출력 매개변수를 사용하면 응집도가 낮은 구조가 만들어집니다.<br>
매개변수는 입력 값으로 사용하는 것이 기본입니다.<br>
매개변수를 출력 값으로 사용하면, 코드를 읽는 사람에게 혼란을 줄 수 있고 가독성 저하의 원인이 됩니다.

### 5.5 매개변수는 최대한 적게 사용하기

메서드에 매개변수가 많다는 것은 메서드가 여러 가지 기능을 처리한다는 의미입니다.<br>
메서드가 처리할 게 많아지면, 그만큼 로직이 복잡해져 이는 다양한 악마들을 불러드립니다.

매개변수가 많아질 수밖에 없다면, 별도의 클래스를 만드는 방법을 검토해 보기 바랍니다.

## 6. 리턴 값

### 6.1 '자료형'을 사용해서 리턴 값의 의도 나타내기

기본 자료형을 사용하면 매개변수를 잘못 전달하는 등의 실수가 발생할 수 있습니다.

기본 자료형을 사용하지 말고, 독자적인 자료형을 사용해서 의도를 명확하게 나타내는 것이 좋습니다.

### 6.2 null 리턴하지 않기

매개변수와 마찬가지로 null을 사용하지 않아야 좋습니다.

### 6.3 오류는 리턴 값으로 리턴하지 말고 예외 발생시키기

어떤 값으로 여러 의미를 나타내는 것을 중의적이라고 합니다.<br>
Location(-1,-1)처럼 특정한 값을 좌표가 아니라, 오류로 다루는 것을 중의적이라고 할 수 있습니다.<br>
중의적으로 쓰면 상황에 따라 의미가 달라지므로, 읽는 사람에게 혼란을 줍니다.<br>
또한 상황 판단을 위해 조건 분기를 사용해야 하므로, 조건 분기가 이곳저곳 늘어납니다.

리턴 값으로 오류 값을 리턴하지 말고, 곧바로 예외를 발생시켜야 합니다.

## 메서드 이름 설계

메서드의 구조적인 문제는 이름에서 드러나는 경우가 많습니다.<br>
'동사 + 목적어' 형태의 메서드 이름은 책무와 상관없는 로직을 구현하도록 유도할 수 있는 이름입니다.<br>
최대한 이름이 동사 하나가 되도록 메서드와 클래스를 설계하는 것이 좋습니다.<br>
이외에도 부적절한 위치에 있는 boolean 메서드도 주의해야 합니다.

## static 메서드와 관련된 주의 사항

static 메서드는 같은 클래스에 정의된 인스턴스 변수를 조작할 수 없습니다.<br>
결국 데이터와 데이터를 조작하는 로직이 분산되어, 응집도가 낮은 구조를 만들 수 있습니다.<br>
static 메서드는 팩토리 메서드, 횡단 관심사 등 응집도가 낮을 때 생기는 문제를 걱정할 필요가 없는 상황에서만 사용합시다.
