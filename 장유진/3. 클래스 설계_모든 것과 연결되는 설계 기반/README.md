# 3장 클래스 설계: 모든 것과 연결되는 설계 기반

## 1. 클래스 단위로도 잘 동작하도록 설계

최소한의 메서드만 외부에 공개할 것

### 1.1 잘 만들어진 클래스의 구성 요소
- 인스턴스 변수
- 인스턴스 변수에 잘못된 값이 할당되지 않게 막고, 정상적으로 조작하는 메서드

### 1.2 클래스의 자기 방어 임무
소프트웨어에서 메서드, 클래스, 모듈 등의 기본적인 단위들은 그 자체로 버그 없이, 언제나 안전하게 사용할 수 있는 품질을 갖추고 있어야 한다.

## 2. 성숙한 클래스 설계 기법

### 2.1 생성자로 정상적인 값 설정
- 클래스 인스턴스를 생성하는 시점에 확실하게 인스턴스 변수가 정상적인 값을 갖게 만든다.
- 잘못된 값이 유입되지 못하게 유효성 검사를 생성자 내부에 정의
- 가드(guard)를 통해 위의 내용을 적용한다.<br>
`guard란, 처리 범위를 벗어나는 조건을 메서드 가장 앞부분에서 확인하는 코드`

### 2.2 데이터를 가진 쪽에 계산 로직 구현
'데이터'와 '데이터를 조작하는 로직'이 분리되어 있으면 응집도가 낮아진다.

### 2.3 불변 변수로 만들어서 예상하지 못한 동작 막기
불변 변수(`final`)로 만들면 변수의 의도와 다르게 사용되는 재할당을 막을 수 있다.

### 2.4 변경하고 싶다면 새로운 인스턴스 만들기
값을 변경하고 싶으면 변경된 값을 가진 새로운 인스턴스를 생성해서 사용한다.

### 2.5 메서드 매개변수와 지역 변수도 불변으로 만들기
- 기본적으로 매개변수는 변경하지 않는 것이 좋다.
- 지역 변수도 불필요한 재할당을 막기 위해 불변으로 만든다.

### 2.6 엉뚱한 값을 전달하지 않도록 하기
기본 자료형(int, String 등)을 사용하면 잘못된 값이 전달될 수 있다.<br>
직접 정의한 독자적인 자료형을 사용하면, 의미가 다른 값을 전달할 경우 에러가 발생할 수 있다.

### 2.7 의미 없는 메서드 추가하지 않기
시스템 사양에 필요하지 않은 메서드를 '선의'로 구현할 경우, 누군가 이를 무심코 사용해서 버그가 발생할 수 있다.

## 3. 클래스 설계 효과

2번에서 진행한 성숙한 클래스 설계 기법으로 인해 다음 7개의 안 좋은 설계가 제거되었다.
- 중복 코드: 필요한 로직을 클래스 내부에 모아서 응집도를 높힘.
- 수정 누락: 중복 코드를 방지하여 수정 누락도 줄어듦.
- 가독성 저하: 필요한 로직을 클래스 내부에 모아서 디버깅 또는 기능 변경 시 관련 로직을 찾으러 돌아다니지 않게 됨.
- 쓰레기 객체: 생성자에서 인스턴스 변수를 확정하므로, 초기화되지 않은 객체가 발생할 수 없음.
- 잘못된 값: 가드와 불변 변수 선언으로 잘못된 값이 들어오지 못하게 막음.
- 생각하지 못한 부수 효과: 불변 변수로 선언하여 잘못된 재할당 방지.
- 값 전달 실수: 직접 정의한 자료형을 사용하여 다른 자료형이 들어오지 못하게 막음.

`클래스 설계란, 인스턴스 변수가 잘못된 상태에 빠지지 않게 하기 위한 구조를 만드는 것`

## 4. 디자인 패턴
디자인 패턴이란, 응집도가 높은 구조로 만들거나, 잘못된 상태로부터 프로그램을 방어하는 등 프로그램의 구조를 개선하는 설계 방법

### 4.1 완전 생성자
잘못된 상태로부터 클래스를 보호하기 위한 디자인 패턴
- 생성자에서 인스턴스 변수를 모두 초기화
- 가드 사용
- 잘못된 재할당을 막기 위해 불변 변수 사용


### 4.2 값 객체
값을 클래스로 나타내는 디자인 패턴. 기본 자료형 대신 사용하는 독자적인 자료형이 이에 해당한다.

### 완전 생성자 + 값 객체
객체 지향 설계에서 폭넓게 사용되는 기법
- 제약과 의도를 자료형으로 표현 가능
- 안전한 코드 작성 가능

## 3장 결론
설계에서 중요한 것은 '데이터'와 '데이터를 조작하는 로직'을 한 곳에 모아 응집도를 높이고,<br>
필요한 메서드만 외부에 공개해서 캡슐화하는 것이다.